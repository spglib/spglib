<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Spglib for Python &#8212; spglib 1.11 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fortran and Ruby interfaces" href="interface.html" />
    <link rel="prev" title="Variables" href="variable.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          spglib</a>
        <span class="navbar-text navbar-version pull-left"><b>1.11</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">How to install spglib C-API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">C-APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Spglib dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="variable.html">Variables</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">Fortran and Ruby interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="definition.html">Definitions and conventions</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Spglib for Python</a><ul>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#using-pip">Using pip</a></li>
<li><a class="reference internal" href="#using-conda">Using conda</a></li>
<li><a class="reference internal" href="#building-using-setup-py">Building using setup.py</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test">Test</a></li>
<li><a class="reference internal" href="#how-to-import-spglib-module">How to import spglib module</a></li>
<li><a class="reference internal" href="#version-number">Version number</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#variables">Variables</a><ul>
<li><a class="reference internal" href="#crystal-structure-cell">Crystal structure (<code class="docutils literal notranslate"><span class="pre">cell</span></code>)</a><ul>
<li><a class="reference internal" href="#ase-atoms-like-input-is-deprecated">ASE Atoms-like input is deprecated.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#symmetry-tolerance-symprec">Symmetry tolerance (<code class="docutils literal notranslate"><span class="pre">symprec</span></code>)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#methods">Methods</a><ul>
<li><a class="reference internal" href="#get-version"><code class="docutils literal notranslate"><span class="pre">get_version</span></code></a></li>
<li><a class="reference internal" href="#get-error-message"><code class="docutils literal notranslate"><span class="pre">get_error_message</span></code></a></li>
<li><a class="reference internal" href="#get-spacegroup"><code class="docutils literal notranslate"><span class="pre">get_spacegroup</span></code></a></li>
<li><a class="reference internal" href="#get-symmetry"><code class="docutils literal notranslate"><span class="pre">get_symmetry</span></code></a></li>
<li><a class="reference internal" href="#refine-cell"><code class="docutils literal notranslate"><span class="pre">refine_cell</span></code></a></li>
<li><a class="reference internal" href="#find-primitive"><code class="docutils literal notranslate"><span class="pre">find_primitive</span></code></a></li>
<li><a class="reference internal" href="#standardize-cell"><code class="docutils literal notranslate"><span class="pre">standardize_cell</span></code></a></li>
<li><a class="reference internal" href="#get-symmetry-dataset"><code class="docutils literal notranslate"><span class="pre">get_symmetry_dataset</span></code></a></li>
<li><a class="reference internal" href="#get-symmetry-from-database"><code class="docutils literal notranslate"><span class="pre">get_symmetry_from_database</span></code></a></li>
<li><a class="reference internal" href="#get-spacegroup-type"><code class="docutils literal notranslate"><span class="pre">get_spacegroup_type</span></code></a></li>
<li><a class="reference internal" href="#get-hall-number-from-symmetry"><code class="docutils literal notranslate"><span class="pre">get_hall_number_from_symmetry</span></code></a></li>
<li><a class="reference internal" href="#niggli-reduce"><code class="docutils literal notranslate"><span class="pre">niggli_reduce</span></code></a></li>
<li><a class="reference internal" href="#delaunay-reduce"><code class="docutils literal notranslate"><span class="pre">delaunay_reduce</span></code></a></li>
<li><a class="reference internal" href="#get-ir-reciprocal-mesh"><code class="docutils literal notranslate"><span class="pre">get_ir_reciprocal_mesh</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="spglib-for-python">
<span id="python-spglib"></span><h1>Spglib for Python<a class="headerlink" href="#spglib-for-python" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#installation" id="id2">Installation</a><ul>
<li><a class="reference internal" href="#using-pip" id="id3">Using pip</a></li>
<li><a class="reference internal" href="#using-conda" id="id4">Using conda</a></li>
<li><a class="reference internal" href="#building-using-setup-py" id="id5">Building using setup.py</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test" id="id6">Test</a></li>
<li><a class="reference internal" href="#how-to-import-spglib-module" id="id7">How to import spglib module</a></li>
<li><a class="reference internal" href="#version-number" id="id8">Version number</a></li>
<li><a class="reference internal" href="#example" id="id9">Example</a></li>
<li><a class="reference internal" href="#variables" id="id10">Variables</a><ul>
<li><a class="reference internal" href="#crystal-structure-cell" id="id11">Crystal structure (<code class="docutils literal notranslate"><span class="pre">cell</span></code>)</a></li>
<li><a class="reference internal" href="#symmetry-tolerance-symprec" id="id12">Symmetry tolerance (<code class="docutils literal notranslate"><span class="pre">symprec</span></code>)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#methods" id="id13">Methods</a><ul>
<li><a class="reference internal" href="#get-version" id="id14"><code class="docutils literal notranslate"><span class="pre">get_version</span></code></a></li>
<li><a class="reference internal" href="#get-error-message" id="id15"><code class="docutils literal notranslate"><span class="pre">get_error_message</span></code></a></li>
<li><a class="reference internal" href="#get-spacegroup" id="id16"><code class="docutils literal notranslate"><span class="pre">get_spacegroup</span></code></a></li>
<li><a class="reference internal" href="#get-symmetry" id="id17"><code class="docutils literal notranslate"><span class="pre">get_symmetry</span></code></a></li>
<li><a class="reference internal" href="#refine-cell" id="id18"><code class="docutils literal notranslate"><span class="pre">refine_cell</span></code></a></li>
<li><a class="reference internal" href="#find-primitive" id="id19"><code class="docutils literal notranslate"><span class="pre">find_primitive</span></code></a></li>
<li><a class="reference internal" href="#standardize-cell" id="id20"><code class="docutils literal notranslate"><span class="pre">standardize_cell</span></code></a></li>
<li><a class="reference internal" href="#get-symmetry-dataset" id="id21"><code class="docutils literal notranslate"><span class="pre">get_symmetry_dataset</span></code></a></li>
<li><a class="reference internal" href="#get-symmetry-from-database" id="id22"><code class="docutils literal notranslate"><span class="pre">get_symmetry_from_database</span></code></a></li>
<li><a class="reference internal" href="#get-spacegroup-type" id="id23"><code class="docutils literal notranslate"><span class="pre">get_spacegroup_type</span></code></a></li>
<li><a class="reference internal" href="#get-hall-number-from-symmetry" id="id24"><code class="docutils literal notranslate"><span class="pre">get_hall_number_from_symmetry</span></code></a></li>
<li><a class="reference internal" href="#niggli-reduce" id="id25"><code class="docutils literal notranslate"><span class="pre">niggli_reduce</span></code></a></li>
<li><a class="reference internal" href="#delaunay-reduce" id="id26"><code class="docutils literal notranslate"><span class="pre">delaunay_reduce</span></code></a></li>
<li><a class="reference internal" href="#get-ir-reciprocal-mesh" id="id27"><code class="docutils literal notranslate"><span class="pre">get_ir_reciprocal_mesh</span></code></a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#id2">Installation</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>The source code is downloaded at
<a class="reference external" href="https://github.com/atztogo/spglib/releases">https://github.com/atztogo/spglib/releases</a> .
But minor updates are not included in this package. If you want the
latest version, you can git-clone the spglib repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">atztogo</span><span class="o">/</span><span class="n">spglib</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>It is also possible to install spglib for python via the following
package distribution services or from building using setup.py.</p>
<p>The following pip and conda packages are made and maintained by
<a class="reference external" href="https://github.com/jochym">Paweł T. Jochym</a>, which is of great help
to keeping spglib handy and useful.</p>
<div class="section" id="using-pip">
<h3><a class="toc-backref" href="#id3">Using pip</a><a class="headerlink" href="#using-pip" title="Permalink to this headline">¶</a></h3>
<p>Numpy is required before the python-spglib installation. The command to
install spglib is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">user</span> <span class="n">spglib</span>
</pre></div>
</div>
<p>If you see the error message like below in the installation process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_spglib</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span><span class="p">:</span> <span class="n">Python</span><span class="o">.</span><span class="n">h</span><span class="p">:</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span>
</pre></div>
</div>
<p>development tools for building python module are additionally
necessary and are installed using OS’s package management system,
e.g.,:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>If your installation by pip failed, you may need to
upgrade setuptools, e.g., by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="o">--</span><span class="n">user</span> <span class="n">setuptools</span>
</pre></div>
</div>
</div>
<div class="section" id="using-conda">
<h3><a class="toc-backref" href="#id4">Using conda</a><a class="headerlink" href="#using-conda" title="Permalink to this headline">¶</a></h3>
<p>Conda is another choice:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">spglib</span>
</pre></div>
</div>
</div>
<div class="section" id="building-using-setup-py">
<h3><a class="toc-backref" href="#id5">Building using setup.py</a><a class="headerlink" href="#building-using-setup-py" title="Permalink to this headline">¶</a></h3>
<p>To manually install python-spglib using <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>, python header
files (python-dev), C-compiler (e.g., gcc, clang), and numpy are
required before the build. The installation steps are shown as
follows:</p>
<ol class="arabic">
<li><p class="first">Go to the <code class="file docutils literal notranslate"><span class="pre">python</span></code> directory</p>
</li>
<li><p class="first">Type the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span> <span class="o">--</span><span class="n">user</span>
</pre></div>
</div>
<p>Document about where spglib is installed is found at the
links below:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.python.org/2/install/#alternate-installation-the-user-scheme">https://docs.python.org/2/install/#alternate-installation-the-user-scheme</a></li>
<li><a class="reference external" href="https://docs.python.org/3/install/#alternate-installation-the-user-scheme">https://docs.python.org/3/install/#alternate-installation-the-user-scheme</a></li>
</ul>
</li>
</ol>
<p>If your installation by setup.py failed, you may need to upgrade
setuptools, e.g., by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="o">--</span><span class="n">user</span> <span class="n">setuptools</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="test">
<h2><a class="toc-backref" href="#id6">Test</a><a class="headerlink" href="#test" title="Permalink to this headline">¶</a></h2>
<p>The test script <code class="file docutils literal notranslate"><span class="pre">test_spglib.py</span></code> is found in <code class="file docutils literal notranslate"><span class="pre">python/test</span></code>
directory. Got to this directory and run this script. It will be like below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">python</span> <span class="n">test_spglib</span><span class="o">.</span><span class="n">py</span>
<span class="n">test_find_primitive</span> <span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">TestSpglib</span><span class="p">)</span> <span class="o">...</span> <span class="n">ok</span>
<span class="n">test_get_symmetry</span> <span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">TestSpglib</span><span class="p">)</span> <span class="o">...</span> <span class="n">ok</span>
<span class="n">test_get_symmetry_dataset</span> <span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">TestSpglib</span><span class="p">)</span> <span class="o">...</span> <span class="n">ok</span>
<span class="n">test_refine_cell</span> <span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">TestSpglib</span><span class="p">)</span> <span class="o">...</span> <span class="n">ok</span>

<span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">4</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">13.147</span><span class="n">s</span>

<span class="n">OK</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-import-spglib-module">
<h2><a class="toc-backref" href="#id7">How to import spglib module</a><a class="headerlink" href="#how-to-import-spglib-module" title="Permalink to this headline">¶</a></h2>
<p><strong>Change in version 1.9.0!</strong></p>
<p>For versions 1.9.x or later:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">spglib</span>
</pre></div>
</div>
<p>For versions 1.8.x or before:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspglib</span> <span class="k">import</span> <span class="n">spglib</span>
</pre></div>
</div>
<p>If the version is not sure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">spglib</span> <span class="k">as</span> <span class="nn">spg</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">pyspglib</span> <span class="k">import</span> <span class="n">spglib</span> <span class="k">as</span> <span class="n">spg</span>
</pre></div>
</div>
</div>
<div class="section" id="version-number">
<h2><a class="toc-backref" href="#id8">Version number</a><a class="headerlink" href="#version-number" title="Permalink to this headline">¶</a></h2>
<p>In version 1.8.3 or later, the version number is obtained by
<code class="docutils literal notranslate"><span class="pre">spglib.__version__</span></code> or <a class="reference internal" href="#method-get-version"><span class="std std-ref">get_version</span></a>.</p>
</div>
<div class="section" id="example">
<h2><a class="toc-backref" href="#id9">Example</a><a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Examples are found in <a class="reference external" href="https://github.com/atztogo/spglib/tree/master/python/examples">examples</a>
directory.</p>
</div>
<div class="section" id="variables">
<span id="py-variables"></span><h2><a class="toc-backref" href="#id10">Variables</a><a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h2>
<div class="section" id="crystal-structure-cell">
<span id="py-variables-crystal-structure"></span><h3><a class="toc-backref" href="#id11">Crystal structure (<code class="docutils literal notranslate"><span class="pre">cell</span></code>)</a><a class="headerlink" href="#crystal-structure-cell" title="Permalink to this headline">¶</a></h3>
<p>A crystal structure is given by a <strong>tuple</strong>. This tuple format is
supported at version 1.9.1 or later.</p>
<p>The tuple format is shown as follows. There are three or four elements
in the tuple: <code class="docutils literal notranslate"><span class="pre">cell</span> <span class="pre">=</span> <span class="pre">(lattice,</span> <span class="pre">positions,</span> <span class="pre">numbers)</span></code> or <code class="docutils literal notranslate"><span class="pre">cell</span> <span class="pre">=</span>
<span class="pre">(lattice,</span> <span class="pre">positions,</span> <span class="pre">numbers,</span> <span class="pre">magmoms)</span></code> where <code class="docutils literal notranslate"><span class="pre">magmoms</span></code> represents
collinear polarizations on atoms and is optional.</p>
<p>Lattice parameters <code class="docutils literal notranslate"><span class="pre">lattice</span></code> are given by a 3x3 matrix with floating
point values, where <span class="math notranslate nohighlight">\(\mathbf{a}, \mathbf{b}, \mathbf{c}\)</span> are
given as rows, which results in the transpose of the definition for
C-API (<a class="reference internal" href="variable.html#variables-lattice"><span class="std std-ref">lattice</span></a>). Fractional atomic positions
<code class="docutils literal notranslate"><span class="pre">positions</span></code> are given by a Nx3 matrix with floating point values,
where N is the number of atoms. Numbers to distinguish atomic species
<code class="docutils literal notranslate"><span class="pre">numbers</span></code> are given by a list of N integers. The collinear polarizations
<code class="docutils literal notranslate"><span class="pre">magmoms</span></code> only work with <code class="docutils literal notranslate"><span class="pre">get_symmetry</span></code> and are given
as a list of N floating point values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lattice</span> <span class="o">=</span> <span class="p">[[</span><span class="n">a_x</span><span class="p">,</span> <span class="n">a_y</span><span class="p">,</span> <span class="n">a_z</span><span class="p">],</span>
           <span class="p">[</span><span class="n">b_x</span><span class="p">,</span> <span class="n">b_y</span><span class="p">,</span> <span class="n">b_z</span><span class="p">],</span>
           <span class="p">[</span><span class="n">c_x</span><span class="p">,</span> <span class="n">c_y</span><span class="p">,</span> <span class="n">c_z</span><span class="p">]]</span>
<span class="n">positions</span> <span class="o">=</span> <span class="p">[[</span><span class="n">a_1</span><span class="p">,</span> <span class="n">b_1</span><span class="p">,</span> <span class="n">c_1</span><span class="p">],</span>
             <span class="p">[</span><span class="n">a_2</span><span class="p">,</span> <span class="n">b_2</span><span class="p">,</span> <span class="n">c_2</span><span class="p">],</span>
             <span class="p">[</span><span class="n">a_3</span><span class="p">,</span> <span class="n">b_3</span><span class="p">,</span> <span class="n">c_3</span><span class="p">],</span>
             <span class="o">...</span><span class="p">]</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="n">n_1</span><span class="p">,</span> <span class="n">n_2</span><span class="p">,</span> <span class="n">n_3</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="n">magmoms</span> <span class="o">=</span> <span class="p">[</span><span class="n">m_1</span><span class="p">,</span> <span class="n">m_2</span><span class="p">,</span> <span class="n">m_3</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>  <span class="c1"># Only works with get_symmetry</span>
</pre></div>
</div>
<p>Version 1.9.5 or later: The methods that use the crsytal strcutre
will return <code class="docutils literal notranslate"><span class="pre">None</span></code> when a crystal structure is not properly given.</p>
<div class="section" id="ase-atoms-like-input-is-deprecated">
<h4>ASE Atoms-like input is deprecated.<a class="headerlink" href="#ase-atoms-like-input-is-deprecated" title="Permalink to this headline">¶</a></h4>
<p>In the previous versions, ASE Atoms-like input was supported, but it
is deprecated. It is recommended to use the above tuple-style input
for the future support. <code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code> is issued at version
1.10.0 or later.</p>
<p>The reason to make this feature deprecated is that ASE Atoms class is
too huge and users may expect spglib can understand its full
feature. However spglib actually collects only the following values
from the ASE Atoms-class instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lattice</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span>
<span class="n">positions</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_scaled_positions</span><span class="p">()</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_atomic_numbers</span><span class="p">()</span>
<span class="n">magmoms</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p>for which the corresponding code is written out of API and it is found
at <a class="reference external" href="https://github.com/atztogo/spglib/blob/e0851894ccdad1abb87d519b228d056128b56806/python/spglib/spglib.py#L737-L741">here</a>. Nevertheless
the ASE Atoms-like input will be accepted for a while.  An alternative
Atoms class (<a class="reference external" href="https://github.com/atztogo/spglib/blob/master/python/examples/atoms.py">atoms.py</a>)
that contains minimum set of methods is prepared in the <a class="reference external" href="https://github.com/atztogo/spglib/tree/master/python/examples">examples</a>
directory. <code class="docutils literal notranslate"><span class="pre">get_symmetry</span></code> with collinear polarizations is not
supported when ASE Atoms-class instance.</p>
</div>
</div>
<div class="section" id="symmetry-tolerance-symprec">
<h3><a class="toc-backref" href="#id12">Symmetry tolerance (<code class="docutils literal notranslate"><span class="pre">symprec</span></code>)</a><a class="headerlink" href="#symmetry-tolerance-symprec" title="Permalink to this headline">¶</a></h3>
<p>Distance tolerance in Cartesian coordinates to find crystal symmetry.</p>
</div>
</div>
<div class="section" id="methods">
<h2><a class="toc-backref" href="#id13">Methods</a><a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<div class="section" id="get-version">
<span id="method-get-version"></span><h3><a class="toc-backref" href="#id14"><code class="docutils literal notranslate"><span class="pre">get_version</span></code></a><a class="headerlink" href="#get-version" title="Permalink to this headline">¶</a></h3>
<p><strong>New in version 1.8.3</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">version</span> <span class="o">=</span> <span class="n">get_version</span><span class="p">()</span>
</pre></div>
</div>
<p>This returns version number of spglib by tuple with three numbers.</p>
</div>
<div class="section" id="get-error-message">
<h3><a class="toc-backref" href="#id15"><code class="docutils literal notranslate"><span class="pre">get_error_message</span></code></a><a class="headerlink" href="#get-error-message" title="Permalink to this headline">¶</a></h3>
<p><strong>New in version 1.9.5</strong></p>
<p><strong>Be careful. This method is not thread safe, i.e., only safely usable
when calling one spglib method per process.</strong></p>
<p>This method is used to see roughly why spglib failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">error_message</span> <span class="o">=</span> <span class="n">get_error_message</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="get-spacegroup">
<h3><a class="toc-backref" href="#id16"><code class="docutils literal notranslate"><span class="pre">get_spacegroup</span></code></a><a class="headerlink" href="#get-spacegroup" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spacegroup</span> <span class="o">=</span> <span class="n">get_spacegroup</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
<p>International space group short symbol and number are obtained as a
string. With <code class="docutils literal notranslate"><span class="pre">symbol_type=1</span></code>, Schoenflies symbol is given instead of
international symbol.</p>
</div>
<div class="section" id="get-symmetry">
<span id="py-method-get-symmetry"></span><h3><a class="toc-backref" href="#id17"><code class="docutils literal notranslate"><span class="pre">get_symmetry</span></code></a><a class="headerlink" href="#get-symmetry" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">symmetry</span> <span class="o">=</span> <span class="n">get_symmetry</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
<p>Symmetry operations are obtained as a dictionary. The key <code class="docutils literal notranslate"><span class="pre">rotation</span></code>
contains a numpy array of integer, which is “number of symmetry
operations” x “3x3 matrices”. The key <code class="docutils literal notranslate"><span class="pre">translation</span></code> contains a numpy
array of float, which is “number of symmetry operations” x
“vectors”. The orders of the rotation matrices and the translation
vectors correspond with each other, e.g. , the second symmetry
operation is organized by the set of the second rotation matrix and second
translation vector in the respective arrays. Therefore a set of
symmetry operations may obtained by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="n">r</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;rotations&#39;</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;translations&#39;</span><span class="p">])]</span>
</pre></div>
</div>
<p>The operations are given with respect to the fractional coordinates
(not for Cartesian coordinates). The rotation matrix and translation
vector are used as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_vector</span><span class="p">[</span><span class="mi">3</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">[</span><span class="mi">3</span><span class="n">x3</span><span class="p">]</span> <span class="o">*</span> <span class="n">vector</span><span class="p">[</span><span class="mi">3</span><span class="n">x1</span><span class="p">]</span> <span class="o">+</span> <span class="n">translation</span><span class="p">[</span><span class="mi">3</span><span class="n">x1</span><span class="p">]</span>
</pre></div>
</div>
<p>The three values in the vector are given for the a, b, and c axes,
respectively. The key <code class="docutils literal notranslate"><span class="pre">equivalent_atoms</span></code> gives a mapping table of
atoms to symmetrically independent atoms. This is used to find
symmetrically equivalent atoms. The numbers contained are the indices
of atoms starting from 0, i.e., the first atom is numbered as 0, and
then 1, 2, 3, … <code class="docutils literal notranslate"><span class="pre">np.unique(equivalent_atoms)</span></code> gives representative
symmetrically independent atoms. A list of atoms that are
symmetrically euivalent to some independent atom (here for example 1
is in <code class="docutils literal notranslate"><span class="pre">equivalent_atom</span></code>) is found by
<code class="docutils literal notranslate"><span class="pre">np.where(equivalent_atom=1)[0]</span></code>. When the search failed, <code class="docutils literal notranslate"><span class="pre">None</span></code>
is returned.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">cell</span></code> is given as a tuple and collinear polarizations are given
as the fourth element of this tuple, symmetry operations are searched
considering this freedome. In ASE Atoms-class object, this is not supported.</p>
</div>
<div class="section" id="refine-cell">
<h3><a class="toc-backref" href="#id18"><code class="docutils literal notranslate"><span class="pre">refine_cell</span></code></a><a class="headerlink" href="#refine-cell" title="Permalink to this headline">¶</a></h3>
<p><strong>Behaviour changed in version 1.8.x</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lattice</span><span class="p">,</span> <span class="n">scaled_positions</span><span class="p">,</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">refine_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
<p>Standardized crystal structure is obtained as a tuple of lattice (a 3x3
numpy array), atomic scaled positions (a numpy array of
[number_of_atoms,3]), and atomic numbers (a 1D numpy array) that are
symmetrized following space group type. When the search
failed, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
<p>The detailed control of standardization of unit cell is achieved using
<code class="docutils literal notranslate"><span class="pre">standardize_cell</span></code>.</p>
</div>
<div class="section" id="find-primitive">
<h3><a class="toc-backref" href="#id19"><code class="docutils literal notranslate"><span class="pre">find_primitive</span></code></a><a class="headerlink" href="#find-primitive" title="Permalink to this headline">¶</a></h3>
<p><strong>Behaviour changed in version 1.8.x</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lattice</span><span class="p">,</span> <span class="n">scaled_positions</span><span class="p">,</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">find_primitive</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
<p>When a primitive cell is found, lattice parameters (a 3x3 numpy array),
scaled positions (a numpy array of [number_of_atoms,3]), and atomic
numbers (a 1D numpy array) is returned. When the search failed,
<code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
<p>The detailed control of standardization of unit cell can be done using
<code class="docutils literal notranslate"><span class="pre">standardize_cell</span></code>.</p>
</div>
<div class="section" id="standardize-cell">
<h3><a class="toc-backref" href="#id20"><code class="docutils literal notranslate"><span class="pre">standardize_cell</span></code></a><a class="headerlink" href="#standardize-cell" title="Permalink to this headline">¶</a></h3>
<p><strong>New in version 1.8.x</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lattice</span><span class="p">,</span> <span class="n">scaled_positions</span><span class="p">,</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">standardize_cell</span><span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="n">to_primitive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">no_idealize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">to_primitive=True</span></code> is used to create the standardized primitive
cell, and <code class="docutils literal notranslate"><span class="pre">no_idealize=True</span></code> disables to idealize lengths and angles
of basis vectors and positions of atoms according to crystal
symmetry. Now <code class="docutils literal notranslate"><span class="pre">refine_cell</span></code> and <code class="docutils literal notranslate"><span class="pre">find_primitive</span></code> are shorthands of
this method with combinations of these options. When the search
failed, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.  is returned. More detailed explanation
is shown in the spglib (C-API) document.</p>
</div>
<div class="section" id="get-symmetry-dataset">
<span id="py-method-get-symmetry-dataset"></span><h3><a class="toc-backref" href="#id21"><code class="docutils literal notranslate"><span class="pre">get_symmetry_dataset</span></code></a><a class="headerlink" href="#get-symmetry-dataset" title="Permalink to this headline">¶</a></h3>
<p><strong>At version 1.9.4, the member ‘choice’ is added.</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">get_symmetry_dataset</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">angle_tolerance</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">hall_number</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">cell</span></code> and <code class="docutils literal notranslate"><span class="pre">symprec</span></code>: See <a class="reference internal" href="#py-variables"><span class="std std-ref">Variables</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">angle_tolerance</span></code>: An experimental argument that controls angle
tolerance between basis vectors. Normally it is not recommended to use
this argument. See a bit more detail at
<a class="reference internal" href="variable.html#variables-angle-tolerance"><span class="std std-ref">angle_tolerance</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">hall_number</span></code> (see the definition of this number at
<a class="reference internal" href="dataset.html#dataset-spg-get-dataset-spacegroup-type"><span class="std std-ref">Space group type</span></a>): The argument to
constrain the space-group-type search only for the Hall symbol
corresponding to it. The mapping from Hall symbols to a
space-group-type is the many-to-one mapping. Without specifying this
option (i.e., in the case of <code class="docutils literal notranslate"><span class="pre">hall_number=0</span></code>), always the first one
(the smallest serial number corresponding to the space-group-type in
<a class="reference external" href="http://pmsl.planet.sci.kobe-u.ac.jp/~seto/?page_id=37&amp;lang=en">list of space groups (Seto’s web site)</a>)
among possible choices and settings is chosen as default. This
argument is useful when the other choice (or settting) is expected to
be hooked. This affects to the obtained values of <code class="docutils literal notranslate"><span class="pre">international</span></code>,
<code class="docutils literal notranslate"><span class="pre">hall</span></code>, <code class="docutils literal notranslate"><span class="pre">hall_number</span></code>, <code class="docutils literal notranslate"><span class="pre">choice</span></code>, <code class="docutils literal notranslate"><span class="pre">transformation_matrix</span></code>,
<code class="docutils literal notranslate"><span class="pre">origin</span> <span class="pre">shift</span></code>, <code class="docutils literal notranslate"><span class="pre">wyckoffs</span></code>, <code class="docutils literal notranslate"><span class="pre">std_lattice</span></code>, <code class="docutils literal notranslate"><span class="pre">std_positions</span></code>,
<code class="docutils literal notranslate"><span class="pre">std_types</span></code> and <code class="docutils literal notranslate"><span class="pre">std_rotation_matrix</span></code>, but not to <code class="docutils literal notranslate"><span class="pre">rotations</span></code>
and <code class="docutils literal notranslate"><span class="pre">translations</span></code> since the later set is defined with respect to
the basis vectors of user’s input (the <code class="docutils literal notranslate"><span class="pre">cell</span></code> argument).</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a dictionary. Short explanations of the values of the
keys are shown below. More the detail may be found at
<a class="reference internal" href="dataset.html#spglib-dataset"><span class="std std-ref">Spglib dataset</span></a>.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">number</span></code>: International space group number</li>
<li><code class="docutils literal notranslate"><span class="pre">international</span></code>: International short symbol</li>
<li><code class="docutils literal notranslate"><span class="pre">hall</span></code>: Hall symbol</li>
<li><code class="docutils literal notranslate"><span class="pre">hall_number</span></code>: Hall number. This number is used in
<a class="reference internal" href="#py-method-get-symmetry-from-database"><span class="std std-ref">get_symmetry_from_database</span></a> and
<a class="reference internal" href="#py-method-get-spacegroup-type"><span class="std std-ref">get_spacegroup_type</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">choice</span></code>: Centring, origin, basis vector setting</li>
<li><code class="docutils literal notranslate"><span class="pre">transformation_matrix</span></code>: See the detail at
<a class="reference internal" href="dataset.html#dataset-origin-shift-and-transformation"><span class="std std-ref">Transformation matrix and origin shift</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">origin</span> <span class="pre">shift</span></code>: See the detail at
<a class="reference internal" href="dataset.html#dataset-origin-shift-and-transformation"><span class="std std-ref">Transformation matrix and origin shift</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">wyckoffs</span></code>: Wyckoff letters</li>
<li><code class="docutils literal notranslate"><span class="pre">equivalent_atoms</span></code>: Mapping table to equivalent atoms</li>
<li><code class="docutils literal notranslate"><span class="pre">mapping_to_primitive</span></code>: Mapping table to atoms in the primitive cell</li>
<li><code class="docutils literal notranslate"><span class="pre">rotations</span></code> and <code class="docutils literal notranslate"><span class="pre">translations</span></code>: Rotation matrices and
translation vectors. See <a class="reference internal" href="#py-method-get-symmetry"><span class="std std-ref">get_symmetry</span></a> for more
details.</li>
<li><code class="docutils literal notranslate"><span class="pre">pointgroup</span></code>: Symbol of the crystallographic point group in
the Hermann–Mauguin notation.</li>
<li><code class="docutils literal notranslate"><span class="pre">std_lattice</span></code>, <code class="docutils literal notranslate"><span class="pre">std_positions</span></code>, <code class="docutils literal notranslate"><span class="pre">std_types</span></code>: Standardized
crystal structure corresponding to a Hall symbol found. These are
equivalently given in the array formats of <code class="docutils literal notranslate"><span class="pre">lattice</span></code>,
<code class="docutils literal notranslate"><span class="pre">positions</span></code>, and <code class="docutils literal notranslate"><span class="pre">numbers</span></code> presented at
<a class="reference internal" href="#py-variables-crystal-structure"><span class="std std-ref">Crystal structure (cell)</span></a>,
respectively.</li>
<li><code class="docutils literal notranslate"><span class="pre">std_rotation_matrix</span></code>: See the detail at <a class="reference internal" href="dataset.html#dataset-idealized-cell"><span class="std std-ref">Standardized crystal structure after idealization</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">std_mapping_to_primitive</span></code>: Mapping table from atoms in the
standardized crystal structure to the atoms in the primitive cell.</li>
</ul>
<p>When the search failed, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
</div>
<div class="section" id="get-symmetry-from-database">
<span id="py-method-get-symmetry-from-database"></span><h3><a class="toc-backref" href="#id22"><code class="docutils literal notranslate"><span class="pre">get_symmetry_from_database</span></code></a><a class="headerlink" href="#get-symmetry-from-database" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">symmetry</span> <span class="o">=</span> <span class="n">get_symmetry_from_database</span><span class="p">(</span><span class="n">hall_number</span><span class="p">)</span>
</pre></div>
</div>
<p>A set of crystallographic symmetry operations corresponding to
<code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is returned by a dictionary where rotation parts and
translation parts are accessed by the keys <code class="docutils literal notranslate"><span class="pre">rotations</span></code> and
<code class="docutils literal notranslate"><span class="pre">translations</span></code>, respectively. The definition of <code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is
found at <a class="reference internal" href="dataset.html#dataset-spg-get-dataset-spacegroup-type"><span class="std std-ref">Space group type</span></a>.</p>
<p>When something wrong happened, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
</div>
<div class="section" id="get-spacegroup-type">
<span id="py-method-get-spacegroup-type"></span><h3><a class="toc-backref" href="#id23"><code class="docutils literal notranslate"><span class="pre">get_spacegroup_type</span></code></a><a class="headerlink" href="#get-spacegroup-type" title="Permalink to this headline">¶</a></h3>
<p><strong>New at version 1.9.4</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spacegroup_type</span> <span class="o">=</span> <span class="n">get_spacegroup_type</span><span class="p">(</span><span class="n">hall_number</span><span class="p">)</span>
</pre></div>
</div>
<p>This function allows to directly access to the space-group-type
database in spglib (spg_database.c). A dictionary is returned. To
specify the space group type with a specific choice, <code class="docutils literal notranslate"><span class="pre">hall_number</span></code>
is used. The definition of <code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is found at
<a class="reference internal" href="dataset.html#dataset-spg-get-dataset-spacegroup-type"><span class="std std-ref">Space group type</span></a>. The keys of the returned
dictionary is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number</span>
<span class="n">international_short</span>
<span class="n">international_full</span>
<span class="n">international</span>
<span class="n">schoenflies</span>
<span class="n">hall_symbol</span>
<span class="n">choice</span>
<span class="n">pointgroup_schoenflies</span>
<span class="n">pointgroup_international</span>
<span class="n">arithmetic_crystal_class_number</span>
<span class="n">arithmetic_crystal_class_symbol</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">spacegroup_type['international_short']</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">dataset['international']</span></code> of <code class="docutils literal notranslate"><span class="pre">get_symmetry_dataset</span></code>,
<code class="docutils literal notranslate"><span class="pre">spacegroup_type['hall_symbol']</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">dataset['hall']</span></code> of <code class="docutils literal notranslate"><span class="pre">get_symmetry_dataset</span></code>, and
<code class="docutils literal notranslate"><span class="pre">spacegroup_type['pointgroup_international']</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">dataset['pointgroup_symbol']</span></code> of <code class="docutils literal notranslate"><span class="pre">get_symmetry_dataset</span></code>.</p>
<p>When something wrong happened, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
</div>
<div class="section" id="get-hall-number-from-symmetry">
<h3><a class="toc-backref" href="#id24"><code class="docutils literal notranslate"><span class="pre">get_hall_number_from_symmetry</span></code></a><a class="headerlink" href="#get-hall-number-from-symmetry" title="Permalink to this headline">¶</a></h3>
<p><strong>experimental</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is obtained from the set of symmetry operations.  The
definition of <code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is found at
<a class="reference internal" href="dataset.html#dataset-spg-get-dataset-spacegroup-type"><span class="std std-ref">Space group type</span></a> and the corresponding
space-group-type information is obtained through
<a class="reference internal" href="#py-method-get-spacegroup-type"><span class="std std-ref">get_spacegroup_type</span></a>.</p>
<p>This is expected to work well for the set of symmetry operations whose
distortion is small. The aim of making this feature is to find
space-group-type for the set of symmetry operations given by the other
source than spglib. <code class="docutils literal notranslate"><span class="pre">symprec</span></code> is in the length of the fractional
coordinates and should be small like <code class="docutils literal notranslate"><span class="pre">1e-5</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_hall_number_from_symmetry</span><span class="p">(</span><span class="n">rotations</span><span class="p">,</span> <span class="n">translations</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="niggli-reduce">
<h3><a class="toc-backref" href="#id25"><code class="docutils literal notranslate"><span class="pre">niggli_reduce</span></code></a><a class="headerlink" href="#niggli-reduce" title="Permalink to this headline">¶</a></h3>
<p><strong>New at version 1.9.4</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">niggli_lattice</span> <span class="o">=</span> <span class="n">niggli_reduce</span><span class="p">(</span><span class="n">lattice</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
<p>Niggli reduction is achieved using this method. The algorithm detail
is found at <a class="reference external" href="https://atztogo.github.io/niggli/">https://atztogo.github.io/niggli/</a> and the references are
there in. Original basis vectors are stored in <code class="docutils literal notranslate"><span class="pre">lattice</span></code> and the
Niggli reduced basis vectors are given in <code class="docutils literal notranslate"><span class="pre">niggli_lattice</span></code>. The
format of basis vectors are found at
<a class="reference internal" href="#py-variables-crystal-structure"><span class="std std-ref">Crystal structure (cell)</span></a>. <code class="docutils literal notranslate"><span class="pre">esp</span></code> is the tolerance
parameter, but unlike <code class="docutils literal notranslate"><span class="pre">symprec</span></code> the unit is not a length. This is
used to check if difference of norms of two basis vectors is close to
zero or not and if two basis vectors are orthogonal by the value of
dot product being close to zero or not.  The detail is shown at
<a class="reference external" href="https://atztogo.github.io/niggli/">https://atztogo.github.io/niggli/</a>.</p>
<p>When the search failed, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
<p>The transformation from original basis vectors <span class="math notranslate nohighlight">\(( \mathbf{a}
\; \mathbf{b} \; \mathbf{c} )\)</span> to final baiss vectors <span class="math notranslate nohighlight">\((
\mathbf{a}' \; \mathbf{b}' \; \mathbf{c}' )\)</span> is achieved by linear
combination of basis vectors with integer coefficients without
rotating coordinates. Therefore the transformation matrix is obtained
by <span class="math notranslate nohighlight">\(\boldsymbol{P} = ( \mathbf{a} \; \mathbf{b} \; \mathbf{c} )
( \mathbf{a}' \; \mathbf{b}' \; \mathbf{c}' )^{-1}\)</span> and the matrix
elements have to be almost integers.</p>
</div>
<div class="section" id="delaunay-reduce">
<h3><a class="toc-backref" href="#id26"><code class="docutils literal notranslate"><span class="pre">delaunay_reduce</span></code></a><a class="headerlink" href="#delaunay-reduce" title="Permalink to this headline">¶</a></h3>
<p><strong>New at version 1.9.4</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">delaunay_lattice</span> <span class="o">=</span> <span class="n">delaunay_reduce</span><span class="p">(</span><span class="n">lattice</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
<p>Delaunay reduction is achieved using this method. The algorithm is
found in the international tables for crystallography
volume A. Original basis vectors are stored in <code class="docutils literal notranslate"><span class="pre">lattice</span></code> and the
Delaunay reduced basis vectors are given in <code class="docutils literal notranslate"><span class="pre">delaunay_lattice</span></code>,
where the format of basis vectors are shown in
<a class="reference internal" href="#py-variables-crystal-structure"><span class="std std-ref">Crystal structure (cell)</span></a>. <code class="docutils literal notranslate"><span class="pre">esp</span></code> is the tolerance
parameter, but unlike <code class="docutils literal notranslate"><span class="pre">symprec</span></code> the unit is not a length. This is
used as the criterion if volume is close to zero or not and if two
basis vectors are orthogonal by the value of dot product being close
to zero or not.</p>
<p>When the search failed, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
<p>The transformation from original basis vectors <span class="math notranslate nohighlight">\(( \mathbf{a}
\; \mathbf{b} \; \mathbf{c} )\)</span> to final basis vectors <span class="math notranslate nohighlight">\((
\mathbf{a}' \; \mathbf{b}' \; \mathbf{c}' )\)</span> is achieved by linear
combination of basis vectors with integer coefficients without
rotating coordinates. Therefore the transformation matrix is obtained
by <span class="math notranslate nohighlight">\(\boldsymbol{P} = ( \mathbf{a} \; \mathbf{b} \; \mathbf{c} )
( \mathbf{a}' \; \mathbf{b}' \; \mathbf{c}' )^{-1}\)</span> and the matrix
elements have to be almost integers.</p>
</div>
<div class="section" id="get-ir-reciprocal-mesh">
<h3><a class="toc-backref" href="#id27"><code class="docutils literal notranslate"><span class="pre">get_ir_reciprocal_mesh</span></code></a><a class="headerlink" href="#get-ir-reciprocal-mesh" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">get_ir_reciprocal_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">is_shift</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Irreducible k-points are obtained from a sampling mesh of k-points.
<code class="docutils literal notranslate"><span class="pre">mesh</span></code> is given by three integers by array and specifies mesh
numbers along reciprocal primitive axis. <code class="docutils literal notranslate"><span class="pre">is_shift</span></code> is given by the
three integers by array. When <code class="docutils literal notranslate"><span class="pre">is_shift</span></code> is set for each reciprocal
primitive axis, the mesh is shifted along the axis in half of adjacent
mesh points irrespective of the mesh numbers. When the value is not 0,
<code class="docutils literal notranslate"><span class="pre">is_shift</span></code> is set.</p>
<p><code class="docutils literal notranslate"><span class="pre">mapping</span></code> and <code class="docutils literal notranslate"><span class="pre">grid</span></code> are returned. <code class="docutils literal notranslate"><span class="pre">grid</span></code> gives the mesh points in
fractional coordinates in reciprocal space. <code class="docutils literal notranslate"><span class="pre">mapping</span></code> gives mapping to
the irreducible k-point indices that are obtained by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">np</span></code> means the numpy module. The grid point is accessed by
<code class="docutils literal notranslate"><span class="pre">grid[index]</span></code>.</p>
<p>When the sesarch failed, <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
<p>An example is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">spglib</span>

<span class="n">lattice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span> <span class="o">*</span> <span class="mf">5.4</span>
<span class="n">positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.875</span><span class="p">,</span> <span class="mf">0.875</span><span class="p">,</span> <span class="mf">0.875</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">]]</span>
<span class="n">numbers</span><span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,]</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="n">lattice</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">numbers</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spglib</span><span class="o">.</span><span class="n">get_spacegroup</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">))</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>

<span class="c1">#</span>
<span class="c1"># Gamma centre mesh</span>
<span class="c1">#</span>
<span class="n">mapping</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">spglib</span><span class="o">.</span><span class="n">get_ir_reciprocal_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">is_shift</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># All k-points and mapping to ir-grid points</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ir_gp_id</span><span class="p">,</span> <span class="n">gp</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mapping</span><span class="p">,</span> <span class="n">grid</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%3d</span><span class="s2"> -&gt;</span><span class="si">%3d</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ir_gp_id</span><span class="p">,</span> <span class="n">gp</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="n">mesh</span><span class="p">))</span>

<span class="c1"># Irreducible k-points</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of ir-kpoints: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mapping</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mapping</span><span class="p">)]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">))</span>

<span class="c1">#</span>
<span class="c1"># With shift</span>
<span class="c1">#</span>
<span class="n">mapping</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">spglib</span><span class="o">.</span><span class="n">get_ir_reciprocal_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">is_shift</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># All k-points and mapping to ir-grid points</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ir_gp_id</span><span class="p">,</span> <span class="n">gp</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mapping</span><span class="p">,</span> <span class="n">grid</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%3d</span><span class="s2"> -&gt;</span><span class="si">%3d</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ir_gp_id</span><span class="p">,</span> <span class="p">(</span><span class="n">gp</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span> <span class="o">/</span> <span class="n">mesh</span><span class="p">))</span>

<span class="c1"># Irreducible k-points</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of ir-kpoints: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mapping</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">((</span><span class="n">grid</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mapping</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span> <span class="o">/</span> <span class="n">mesh</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/python-spglib.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2009, Atsushi Togo.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>